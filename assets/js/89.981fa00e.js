(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{571:function(n,s,a){"use strict";a.r(s);var t=a(2),e=Object(t.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h2",{attrs:{id:"简单应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单应用"}},[n._v("#")]),n._v(" 简单应用")]),n._v(" "),s("ol",[s("li",[n._v("导入依赖。在common中导入maven依赖后，我们就可以在各个工程中进行使用")]),n._v(" "),s("li",[n._v("在8848的nacos服务中配置好响应的配置文件\n"),s("img",{attrs:{src:"/subject/layman-cloud/cloud-3-nacos.png",alt:"0001"}})]),n._v(" "),s("li",[n._v("在Spring Boot使用@Values注解中进行常规操作的文件取得，这样在我们访问这个Controller的时候，就可以直接得到配置中心中发布的配置。")])]),n._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[n._v("  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"${coupon.user.name}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("private")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("String")]),n._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[n._v("@Value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"${coupon.user.age}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("private")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("Integer")]),n._v(" age"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br")])]),s("ol",{attrs:{start:"4"}},[s("li",[n._v("在配置文件中进行配置，默认规则是，如果配置中心存在则优先")]),n._v(" "),s("li",[n._v("动态获取，需要再相应的Controller上添加@RefreshScope注解来实现动态获取")])]),n._v(" "),s("h2",{attrs:{id:"命名空间-配置集-配置集id-配置分组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命名空间-配置集-配置集id-配置分组"}},[n._v("#")]),n._v(" 命名空间,配置集，配置集ID，配置分组")]),n._v(" "),s("p",[n._v("负责配置隔离，默认为public。\n比如基于环境进行隔离，为开发，测试，生产环境进行配置，我个人理解就像单体建构下设置多个properties文件一样。")]),n._v(" "),s("p",[s("img",{attrs:{src:"/subject/layman-cloud/nacos-namespace.png",alt:"0001"}}),n._v("\n当然，也可以依据各个微服务不同来进行隔离，比如为不同的微服务创建不同的配置文件")]),n._v(" "),s("ul",[s("li",[n._v("配置集：所有配置的集合")]),n._v(" "),s("li",[n._v("配置集ID：Data ID，可以理解为spirng环境中的文件名")]),n._v(" "),s("li",[n._v("配置分组：逻辑分组")])]),n._v(" "),s("p",[n._v("我们可以组织一个案例\n每个微服务创建自己的命名空间，使用配置分组区别环境（dev,test,prod）\n"),s("img",{attrs:{src:"/subject/layman-cloud/nacos-group.png",alt:"0001"}}),n._v("\n只需要在bootstrap.properties中进行如下配置\n···\nspring.cloud.nacos.config.namespace=6109967a-a144-4aad-82fd-2b837887fc2a\nspring.cloud.nacos.config.group=dev\n···")]),n._v(" "),s("p",[n._v("当然，为了配置文件进行简化，我们往往可以把一个大的配置文件进行简化和拆解，就等于我们在配置中心中进行了拆解和合并")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("spring.cloud.nacos.config.name=layman-coupon\nspring.cloud.nacos.config.server-addr=127.0.0.1:8848\nspring.cloud.nacos.config.namespace=347a8628-7a40-430c-a1d2-3e17da9ebdb8\n\nspring.cloud.nacos.config.extension-configs[0].data-id=mybatis.yml\nspring.cloud.nacos.config.extension-configs[0].group=dev\nspring.cloud.nacos.config.extension-configs[0].refresh=true\n\nspring.cloud.nacos.config.extension-configs[1].data-id=datasource.yml\nspring.cloud.nacos.config.extension-configs[1].group=dev\nspring.cloud.nacos.config.extension-configs[1].refresh=true\n\nspring.cloud.nacos.config.extension-configs[2].data-id=others.yml\nspring.cloud.nacos.config.extension-configs[2].group=dev\nspring.cloud.nacos.config.extension-configs[2].refresh=true\n\nspring.cloud.nacos.config.extension-configs[3].data-id=layman-coupon.properties\nspring.cloud.nacos.config.extension-configs[3].group=dev\nspring.cloud.nacos.config.extension-configs[3].refresh=true\n\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br")])]),s("p",[n._v("在nacos配置中心的各个文件如下\n"),s("img",{attrs:{src:"/subject/layman-cloud/nacos-ymls.png",alt:"0001"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);